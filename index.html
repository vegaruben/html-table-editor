<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HTML Table Editor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        table, th, td {
            border: 1px solid #333;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        button {
            margin: 2px 2px;
            padding: 5px 10px;
            font-size: 12px;
        }
        .header-actions {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .header-wrapper {
            display: flex;
            align-items: center;
        }
    </style>
</head>
<body>
    <h2>HTML Table Editor</h2>
    <table id="editableTable">
        <thead>
            <tr id="headerRow">
                <th>
                    <div class="header-wrapper">
                        <span contenteditable="true">Column 1</span>
                        <div class="header-actions">
                            <button onclick="addColumn(this)">+</button>
                            <button onclick="removeColumn(this)">−</button>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="header-wrapper">
                        <span contenteditable="true">Column 2</span>
                        <div class="header-actions">
                            <button onclick="addColumn(this)">+</button>
                            <button onclick="removeColumn(this)">−</button>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="header-wrapper">
                        <span contenteditable="true">Column 3</span>
                        <div class="header-actions">
                            <button onclick="addColumn(this)">+</button>
                            <button onclick="removeColumn(this)">−</button>
                        </div>
                    </div>
                </th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td contenteditable="true">Row 1 Col 1</td>
                <td contenteditable="true">Row 1 Col 2</td>
                <td contenteditable="true">Row 1 Col 3</td>
                <td><button onclick="deleteRow(this)">Delete</button></td>
            </tr>
        </tbody>
    </table>
    <button onclick="addRow()">Add Row</button>

    <script>
        function addRow() {
            const table = document.getElementById("editableTable").getElementsByTagName('tbody')[0];
            const header = document.getElementById("headerRow");
            const colCount = header.children.length - 1; // exclude Actions column
            const newRow = table.insertRow();
            for (let i = 0; i < colCount; i++) {
                const cell = newRow.insertCell(i);
                cell.contentEditable = "true";
                cell.innerText = `Row ${table.rows.length} Col ${i + 1}`;
            }
            const actionCell = newRow.insertCell(colCount);
            actionCell.innerHTML = '<button onclick="deleteRow(this)">Delete</button>';
        }

        function deleteRow(button) {
            const row = button.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }

        function addColumn(button) {
            const th = button.closest('th');
            const headerRow = document.getElementById('headerRow');
            const ths = Array.from(headerRow.children);
            const colIndex = ths.indexOf(th);

            // Create new header cell
            const newTh = document.createElement('th');
            newTh.innerHTML = `
                <div class="header-wrapper">
                    <span contenteditable="true">New Column</span>
                    <div class="header-actions">
                        <button onclick="addColumn(this)">+</button>
                        <button onclick="removeColumn(this)">−</button>
                    </div>
                </div>
            `;

            // Insert before the Actions column
            if (colIndex === ths.length - 1) {
                headerRow.insertBefore(newTh, th.nextSibling);
            } else {
                headerRow.insertBefore(newTh, ths[colIndex + 1]);
            }

            // Add new cell to each row in tbody
            const table = document.getElementById("editableTable");
            const tbody = table.getElementsByTagName('tbody')[0];
            for (let row of tbody.rows) {
                const newCell = row.insertCell(colIndex);
                newCell.contentEditable = "true";
                newCell.innerText = `Row ${row.rowIndex + 1} New Col`;
            }
        }

        function removeColumn(button) {
            const th = button.closest('th');
            const headerRow = document.getElementById('headerRow');
            const ths = Array.from(headerRow.children);
            const colIndex = ths.indexOf(th);

            // Prevent removing Actions column
            if (colIndex === ths.length - 1) return;

            // Prevent removing last column
            if (ths.length <= 2) return;

            headerRow.removeChild(th);

            // Remove cell from each row in tbody
            const table = document.getElementById("editableTable");
            const tbody = table.getElementsByTagName('tbody')[0];
            for (let row of tbody.rows) {
                row.deleteCell(colIndex);
            }
        }
    </script>
</body>
</html>.